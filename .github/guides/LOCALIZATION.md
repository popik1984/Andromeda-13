# Руководство по локализации проекта Андромеда-13

Руководство описывает стандарты локализации и работы с текстом на русском языке в проекте [A13](https://github.com/Andromeda-Space-Station/Andromeda-byond.git). Его основная цель — обеспечить единство и согласованность текстов внутри проекта, а также упростить процесс проведения ревью.

Оно рекомендуется к прочтению абсолютно всем: тем, кто целенаправленно занимается локализацией, тем, кто занимается портированием с других билдов, и тем, кто добавляет авторский контент. Даже если вы уже давно _смешарик_, не поленитесь ознакомиться с этим руководством. Возможно, вы найдёте в нём что-то новое и полезное для себя.

Информация в этом руководстве структурирована таким образом, чтобы облегчить её восприятие для тех, кто впервые знакомится с ней. Тем не менее, почти все блоки представляют собой отдельные разделы, которые можно рассматривать независимо друг от друга.

## Содержание

1. [Типографика и правописание](#типографика-и-правописание)
   - [Кавычки](#кавычки)
   - [Дефис и тире](#дефис-и-тире)
   - [Буква Ё](#буква-ё)
2. [Стиль написания текстов](#стиль-написания-текстов)
   - [Обращение к игроку](#обращение-к-игроку)
   - [Лаконичность названий](#лаконичность-названий)
   - [Перевод частных имён](#перевод-частных-имён)
   - [Объём текста](#объём-текста)
   - [Какими должны быть названия и описания?](#какими-должны-быть-названия-и-описания)
3. [Специальные функции локализации](#специальные-функции-локализации)
   - [Гендеры](#гендеры)
   - [Специализированные функции](#специализированные-функции)
   - [Основные функции](#основные-функции)
     - [Гендеризация](#гендеризация--genderize_ru)
     - [Плюрализация](#плюрализация--pluralize_ru)
     - [Склонение единиц измерения](#склонение-единиц-измерения--declension_ru)
     - [Капитализация регистра](#капитализация-регистра--capitalize)
     - [Балуны](#балуны)
       - [Один наблюдатель](#один-наблюдатель--balloon_alert)
       - [Несколько наблюдателей](#несколько-наблюдателей--balloon_alert_to_viewers)
4. [Локализация названий](#локализация-названий)
   - [Перевод названий](#перевод-названий)
   - [Падежи](#падежи)
   - ["Рунеймсы"](#рунеймсы)
     - [Принцип работы](#принцип-работы)
     - [Приминение](#приминение)
5. [Технические аспекты](#технические-аспекты)
   - [Использование дефайнов](#использование-дефайнов)
   - [Что НЕЛЬЗЯ переводить?](#что-нельзя-переводить)
6. [Полезные инструменты и глоссарий](#полезные-инструменты-и-глоссарий)
   - [Глоссарий проекта](#глоссарий-проекта)
   - [Полезные инструменты](#полезные-инструменты)

## Типографика и правописание

### Кавычки

В локализации используются только прямые кавычки `\"\"`. Символ обратного слеша `\` служит для экранирования — он указывает, что следующий за ним символ следует воспринимать как часть текста, а не как специальный символ.

**В нашей локализации не используются типографически правильные кавычки-ёлочки `«»` и кавычки-запятые `„“`!**

### Дефис и тире

Символы дефиса(`-`) и тире(`—`) выполняют разные функции:

- **Дефис (`-`)**
  – короткий знак, который служит для соединения частей слова. Он применяется для сложных слов, приставок и при переносе слов.
- **Тире (`—`)**
  – это длинный знак, который разделяет части предложения. Он применяется для обозначения пауз в речи, для указания диапазонов и для пояснения. Чтобы поставить тире, можно воспользоваться сочетанием клавиш `ALT + 0151`.

### Буква Ё

В русском алфавите 33 буквы. Буква _Ё_ не является строго обязательной, но её использование помогает лучше понять смысл фраз. **Кроме этого, она важна для правильного прочтения слов с помощью Text-To-Speech.** Не пренебрегайте ею.

## Стиль написания текстов

### Обращение к игроку

В большинстве случаев к игроку в тексте следует обращаться на **_Вы_**. Однако если в контексте используется стилистическое пренебрежение, например, в репликах _Колосса_ или _Его Величества_ к игроку, то допустимо обращение на **_Ты_**.

### Лаконичность названий

При локализации часто получаются громоздкие названия, которые требуют сокращения. Старайтесь делать названия короче, не теряя при этом важные детали.

```DM
// Плохо
"Модуль гиперсуперпупер важности для Лафуфу"
// Хорошо
"Модуль важности Лабубу"
```

### Перевод частных имён

Мы можем использовать либо транслитерацию, либо локализацию частных имён. Оба варианта являются допустимыми, и выбор зависит от конкретной ситуации.

```DM
// Плохо
"Mr. Chang" --> "Дядя Кимчи"
"Getmore Chocolate Corp" --> "Гетмор Шоколад Ко"
// Хорошо
"Mr. Chang" --> "Мистер Чанг"
"Getmore Chocolate Corp" --> "Шоколадное изобилие"
```

### Объём текста

Иногда кажется, что использование большого количества "воды" в описании может быть полезным. Однако на практике это может привести к негативным последствиям: перегружать игрока ненужной информацией и загромождать чат. Старайтесь не добавлять слишком много деталей, которые не имеют отношения к геймплею или лору.

```DM
// Пример перегруженного описания
desc = "Специализированная тактическая гарнитура, выполненная из титано-алюминевого сплава с каркасом из композитного полимера. \
Система активного шумоподавления поддерживает громкость окружения на комфортном уровне, защищая органы слуха пользователя от \
громких звуков и обеспечивая отличную слышимость в условиях интенсивного боя. Встроенное телекоммуникационное оборудование \
позволяет поддерживать связь с составом службы безопасности и командным составом в реальном времени. Используется местным Главой Службы Безопасности."
```

### Какими должны быть названия и описания?

Нет универсальной формулы, но есть несколько советов.

- Старайтесь использовать либо уже готовые конструкции (например, с коробкой), либо придумывайте свои и используйте их.
- Не используйте огромные нейросетевые конструкции.
- **Читайте, что предлагает вам переводчик.**
- Делайте хорошо, плохо не делайте.

```DM
// Плохо
desc = "В коробке находятся две гранаты, которые представляют собой кластеры, заполненные газообразной плазмой."
// Хорошо
desc = "Коробка, содержащая 2 кластерные гранаты, наполненные газообразной плазмой."
```

## Специальные функции локализации

Эти функции призваны облегчить процесс локализации. Их использование является обязательным.

### Гендеры

В _Byond_ существует собственная система полов.

| Константа  | Значение      |
| ---------- | ------------- |
| **MALE**   | Мужской       |
| **FEMALE** | Женский       |
| **NEUTER** | Средний       |
| **PLURAL** | Множественный |

Множественный пол может показаться необычным, но он используется у парных объектов (перчатки, обувь) и некоторых существ (например, Дион).

```DM
/obj/labubu
name = "Labubu"
desc = "Самая пушистая Лабубу."
gender = FEMALE
```

### Специализированные функции

Существуют некоторые редко используемые и специализированные функции, которые нечасто применяются в процессе локализации, но о них всё же стоит упомянуть. К таким функциям относятся, например, `dir2rustext` и `russian_list`, которые часто являются аналогами английских функций.

### Основные функции

Несколько ключевых функций, которые являются неотъемлемой частью процесса локализации.

#### **Гендеризация – `genderize_ru`**

Выбор слова в зависимости от гендера – `genderize_ru(пол, мужской, женский, средний, множественный)`.

**НЕ ИСПОЛЬЗУЙТЕ ЭТОТ ПРОК НАПРЯМУЮ!**
Вместо этого используйте готовые макросы, расположенные в файле `code/__HELPERS/localization.dm`. Из этих макросов можно собрать всё необходимое.

```DM
user.gender = FEMALE
"[GEND_HE_SHE_CAP(user)] съел[GEND_A_O_I(user)] мороженку!" // "Она съела мороженку!"
```

#### **Плюрализация – `pluralize_ru`**

Выбор между единственным и множественным числом (укороченная версия `genderize_ru`) – `pluralize_ru(пол, одиночный, множественный)`.

**НЕ ИСПОЛЬЗУЙТЕ ЭТОТ ПРОК НАПРЯМУЮ!**
Вместо этого используйте готовые макросы, расположенные в файле `code/__HELPERS/localization.dm`.

```DM
user.name = "Вася Пупкин"
user.gender = MALE
"[user] откашлива[PLUR_ET_YUT(user)] бабочек!" // "Вася Пупкин откашливает бабочек!"
```

#### **Склонение единиц измерения – `declension_ru`**

Выбор правильной формы слова в зависимости от числа – `declension_ru(число, одиночное, двойное, множественное)`.

_Этот прок не полностью стандартизирован под макросы, поэтому его можно использовать напрямую._

```DM
// DECL_CREDIT это тоже самое, что declension_ru(num, "", "а", "ов")
amount = 102
"Письмо содержит [amount] символ[DECL_CREDIT(amount)]."  // "Письмо содержит 102 символа."
```

#### **Капитализация регистра — `capitalize`**

Изменяет регистр первого символа строки на верхний – `capitalize(текст)`.

```DM
var/mob_name = "клоун"
"[capitalize(mob_name)] убегает!" // "Клоун убегает!"
```

### Балуны

#### Один наблюдатель — `balloon_alert`

Отображение всплывающего и исчезающего текста над объектом – `объект.balloon_alert(наблюдатель, текст)`:

Часто при локализации или портированиях, придётся переделывать некоторый текст в `balloon_alert()`. Использование этой функции повышает иммерсивность, а также позволяет разгрузить чат от множества повторяющихся сообщений.

**Некоторые правила использования `balloon_alert()`:**

- Все балуны должны начинаться с буквы нижнего регистра. Это правило проверяется CI. Однако есть исключения, когда предложение начинается со слов _ИИ_ и подобных, в таких случаях следует использовать `UNLINT()`.
- Балуны должны быть написаны в нейтральном стиле. Эмоциональность и экспрессивность недопустима.
- Балуны должны быть короткими и информативными (не более 20-25 символов).
- Не используйте функции для вывода текста внутри сообщения балуна, если они могут вернуть слишком длинную строку (например, `declent_ru()`). Вместо этого используйте общие названия для объектов, о которых идёт речь, исходя из контекста.
- В конце балунов не ставятся знаки препинания, за исключением восклицательного знака `!`, который используется в конце сообщений, предупреждающих или сигнализирующих о чём-то. Обычно после них следует `return`.
- Балуны не надо использовать, если у игрока открыт **TGUI** интерфейс. Он просто не увидит сообщения.

```DM
// Плохо
user.balloon_alert(user, "вам нужны две руки, чтобы сделать это!")
user.balloon_alert(user, "Техпанель открыта!")
user.balloon_alert(user, "[held_item.declent_ru(NOMINATIVE)] выпадает из руки!")

// Хорошо
user.balloon_alert(user, "нужны обе руки!")
user.balloon_alert(user, "[active ? "включено" : "выключено"]")
user.balloon_alert(user, "плата извлечена")
```

#### Несколько наблюдателей — `balloon_alert_to_viewers`

#### **Балуны для зрителей – `balloon_alert_to_viewers`**

Показ всплывающего текста всем окружающим наблюдателям – `объект.balloon_alert_to_viewers(сообщение, сообщение_для_себя, дистанция_обзора, список_исключений)`:

```DM
user.balloon_alert_to_viewers("вставляет карту", "карта вставлена")
user.balloon_alert_to_viewers("чинит [declent_ru(NOMINATIVE)]...", "починка [declent_ru(NOMINATIVE)]...")
```

## Локализация названий

### Перевод названий

**Мы не переводим `name`**! Исключением служит _авторский контент_, но это всё ещё не желательно и крайне **не рекомендуется**! Для прописывания названий на русском языке существует конструкция `ru_names` и функция их вызова `declent_ru()`.

### Падежи

Падежи необходимы для `ru_names`. Наиболее простой и эффективный способ их написания — использование нейросети.

| Падеж                              | Вопрос        | Пример                  |
| ---------------------------------- | ------------- | ----------------------- |
| **NOMINATIVE**<br>(Именительный)   | Кто? Что?     | Клоун и ассистуха       |
| **GENITIVE**<br>(Родительный)      | Кого? Чего?   | Клоуна и ассистухи      |
| **DATIVE**<br>(Дательный)          | Кому? Чему?   | Клоуну и ассистухе      |
| **ACCUSATIVE**<br>(Винительный)    | Кого? Что?    | Клоуна и ассистуху      |
| **INSTRUMENTAL**<br>(Творительный) | Кем? Чем?     | Клоуном и ассистухой    |
| **PREPOSITIONAL**<br>(Предложный)  | О ком? О чём? | О клоуне и об ассистухе |

### "Рунеймсы"

#### Принцип работы

- **Цепочка получения рунеймов**:
  `declent_ru`. `ru_names` --> `get_ru_names_cached()` --> `name`. Если какой-либо из этих элементов отсутствует (`null`), то выбирается следующий в цепочке.

- **Функция `get_ru_names_cached()`**:
  При первом вызове получает список `ru_names` из `get_ru_names()` и кэширует его в глобальный список, используя тип объекта в качестве ключа. При последующих вызовах список извлекается из кэша.

- **Переопределение `ru_names`**:
  Если `ru_names` являются статическими, то необходимо переопределить `get_ru_names()`. Если же они динамические, то можно переопределить `get_ru_names_cached()` или задать значение `ru_names`, в зависимости от конкретной ситуации.

- **Кэширование и обнуление `ru_names`**:
  Все `ru_names` при создании объекта помещаются в кэш для последующего извлечения с помощью `get_ru_names_cached()` и обнуляются. **Важно**: **Не добавляйте `ru_names` к атомам**, если ваши `ru_names` являются статическими. Вместо этого переопределите `get_ru_names()`.

#### Применение

На практике, в большинстве случаев, мы используем функцию `get_ru_names()` для записи русских названий в разных падежах.

```DM
/obj/structure/sign/mining/survival
	name = "shelter sign"
	desc = "Яркий знак, обозначающий безопасное укрытие."
	icon_state = "survival"

/obj/structure/sign/mining/survival/get_ru_names()
	return alist(
		NOMINATIVE = "знак убежища",
		GENITIVE = "знака убежища",
		DATIVE = "знаку убежища",
		ACCUSATIVE = "знак убежища",
		INSTRUMENTAL = "знаком убежища",
		PREPOSITIONAL = "знаке убежища",
	)
```

Затем они подставляются в различные тексты с помощью функции `declent_ru()`. Даже если конкретный объект не имеет своих уникальных функций, куда должны вызываться его _рунеймсы_, они всегда используются в других местах.

```DM
"Вы ударяете [declent_ru(ACCUSATIVE)]!" // "Вы ударяете знак убежища!"
```

В данном случае это тоже самое, что `src.declent_ru(ACCUSATIVE)`.

## Технические аспекты

### Использование дефайнов

Это чётко прописано в нашем [руководстве по стилю кода](/.github/guides/STYLE.md), но стоит повторить здесь. Если вы переводите строки, на которые установлены проверки, то следует использовать дефайны.

```DM
/datum/proc/do_the_thing(thing_to_do)
	switch(thing_to_do)
		if("биба")
			(...)
		if("боба")
			(...)
```

Подобные проверки на строки очень опасны. **Используйте дефайны!**

```DM
#define BIBA "биба"
#define BOBA "боба"
/datum/proc/do_the_thing(thing_to_do)
	switch(thing_to_do)
		if(BIBA)
			(...)
		if(BOBA)
			(...)
```

### Что НЕЛЬЗЯ переводить?

Код очень разнообразен, и невозможно перечислить всё, что нельзя трогать. Однако можно выделить несколько моментов, которые точно нельзя переводить.

1. **Логирование**:
   Мы никогда не переводим логи. Иногда в логах могут быть прописаны переменные, и в процессе локализации в них может попасть перевод, что нежелательно. Практически во всех функциях логирования присутствует слово _log_, поэтому будьте внимательны, и всё будет в порядке.

```DM
add_attack_logs(src, src, "Attempted suicide as special role")
message_admins("[src] with a special role attempted suicide at [ADMIN_JMP(src)]")
```

2. **Комментарии**:
   В нашем репозитории все комментарии должны быть на русском языке.
   Комментарии в _DreamMaker_ начинаются с `//` или `/** */` для многострочных комментариев.

3. **База данных**:
   Это касается не столько кода, который работает с базами данных, сколько того, что туда попадает. Иногда это может привести к бесконечным рантаймам и другим проблемам. Если вы делаете это целенаправленно, убедитесь, что всё в порядке, протестировав базу данных локально.

## Полезные инструменты и глоссарий

### Полезные инструменты

1. [DeepSeek](https://chat.deepseek.com)
   Он реально умный, в этом маленьком ИИ есть большие мысли. ОН УМНЫЙ! (https://www.youtube.com/watch?v=Y_6fqQDYTJk)
   А если без шуток, то он может помочь с кодом и переводом. Главное задать в начале ему смысл, что ты работаешь над SS13.
   Билд А13 — это буквально работа двух, что делят один мозг, это [Rewokin и DeepSeek](/.github/images/kartinochki/rewokin_and_deepseek.png)

### Глоссарий проекта

КОГДА НИБУДЬ СДЕЛАЮ!!! – это словарь, который был создан энтузиастами, чтобы облегчить поиск готовых решений и поддерживать единообразие формулировок и терминологии.

В глоссарии собраны часто встречающиеся слова, которые могут иметь разные переводы, например, _beaker_ или _cyborg_. Кроме того, он содержит отдельные списки, сгруппированные по различным признакам, например, _названия отделов_ или _станционные роли_.

Заполнение глоссария является добровольным, но если вы хотите, чтобы какое-то слово переводилось определённым образом, пожалуйста, внесите его перевод в глоссарий.

**Пожалуйста, относитесь серьёзно к поддержанию единообразия формулировок! Спасибо!**
